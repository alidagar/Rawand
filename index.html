<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Rawand Optical | Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø´Ø§Ù…Ù„Ø©</title>
    <link rel="apple-touch-icon" href="https://assets.softr-files.com/applications/1332b07e-2803-4ca2-961e-48de84f7f376/assets/c34235fe-b50f-4223-af79-8554e3437b9f.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap');
        body { font-family: 'Tajawal', sans-serif; background-color: #f8fafc; -webkit-tap-highlight-color: transparent; }
        .glass { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); }
        .active-tab { background-color: #063356 !important; color: white !important; transform: scale(1.05); }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .lens-card { transition: all 0.2s ease; }
    </style>
</head>
<body class="pb-20">

    <header class="glass sticky top-0 z-50 border-b border-gray-100 p-4 shadow-sm">
        <div class="max-w-4xl mx-auto flex justify-between items-center">
            <img src="https://assets.softr-files.com/applications/1332b07e-2803-4ca2-961e-48de84f7f376/assets/c5680a02-6638-4d63-9827-84c7e087b62b.png" class="h-10">
            <div class="text-left">
                <h1 class="text-xl font-black text-[#063356]">RAWAND</h1>
                <p class="text-[10px] text-gray-400 font-bold tracking-widest uppercase">Price List System</p>
            </div>
        </div>
    </header>

    <main class="max-w-4xl mx-auto px-4 mt-6">
        <div class="relative mb-6">
            <input type="text" id="searchInput" placeholder="Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬ØŒ Ù‚ÙŠØ§Ø³ØŒ Ø£Ùˆ Ø³Ø¹Ø±..." 
                class="w-full p-4 rounded-2xl border-none shadow-lg outline-none text-right text-lg focus:ring-2 focus:ring-blue-500 transition-all">
            <span class="absolute left-4 top-4 opacity-30">ğŸ”</span>
        </div>

        <div id="tabsContainer" class="flex gap-2 overflow-x-auto pb-4 no-scrollbar mb-6">
            </div>

        <div id="cardsGrid" class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div id="loader" class="col-span-full text-center py-20">
                <div class="animate-spin inline-block w-10 h-10 border-4 border-[#063356] border-t-transparent rounded-full mb-4"></div>
                <p class="text-gray-400 font-bold">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ø¹Ø§Ø±...</p>
            </div>
        </div>
    </main>

<script>
    const sheetId = '11rfaJLxUx5CIc_znlntQ3udyqPujSAPXFFRFjAsePlk';
    
    // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ§Ø¨Ø§Øª (ØªØ£ÙƒØ¯ Ø£Ù†Ù‡Ø§ ØªØ·Ø§Ø¨Ù‚ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ ÙÙŠ Ø§Ù„Ø´ÙŠØª Ø¨Ø§Ù„Ù…Ù„ÙŠ)
    const tabs = ['Zeiss', 'Hoya', 'Nova', 'Divel', 'Synchrony', 'Local Lenses', 'Contact Lenses'];
    
    let currentData = [];

    async function fetchTabData(tabName) {
        document.getElementById('cardsGrid').innerHTML = '<div class="col-span-full text-center py-20 text-gray-400 animate-pulse font-bold">Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª ' + tabName + '...</div>';
        
        // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø­Ø±Ùƒ Google Visualization Ù„Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ€ JSON
        const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(tabName)}`;
        
        try {
            const response = await fetch(url);
            const text = await response.text();
            // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ø£Ù† Ø¬ÙˆØ¬Ù„ ØªØ¶Ø¹ Ù†ØµØ§Ù‹ Ø¥Ø¶Ø§ÙÙŠØ§Ù‹ Ù‚Ø¨Ù„ Ø§Ù„Ù€ JSON
            const json = JSON.parse(text.substring(47, text.length - 2));
            
            const cols = json.table.cols.map(c => c.label || "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª");
            const rows = json.table.rows.map(r => {
                let rowObj = {};
                r.c.forEach((cell, i) => {
                    rowObj[cols[i]] = cell ? (cell.v || cell.f || "") : "";
                });
                return rowObj;
            });
            
            currentData = rows;
            renderCards(rows);
        } catch (e) {
            console.error("Error:", e);
            document.getElementById('cardsGrid').innerHTML = '<div class="col-span-full text-center py-20 text-red-400">ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŒ ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.</div>';
        }
    }

    function renderCards(data) {
        const grid = document.getElementById('cardsGrid');
        if (data.length === 0) {
            grid.innerHTML = '<div class="col-span-full text-center py-20 text-gray-400 italic">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ø¨Ø­Ø«Ùƒ</div>';
            return;
        }

        grid.innerHTML = data.map(item => {
            const keys = Object.keys(item);
            
            // Ù…Ø­Ø§ÙˆÙ„Ø© Ø°ÙƒÙŠØ© Ù„Ø¥ÙŠØ¬Ø§Ø¯ Ø§Ù„Ø³Ø¹Ø± ÙˆØ§Ù„Ø§Ø³Ù…
            const priceKey = keys.find(k => k.includes('Ø³Ø¹Ø±') || k.toLowerCase().includes('price') || k.includes('Price')) || keys[1];
            const nameKey = keys.find(k => k.includes('Ù†ÙˆØ¹') || k.includes('Ø§Ø³Ù…') || k.toLowerCase().includes('name') || k.includes('Brand') || k.includes('Product')) || keys[0];

            return `
                <div class="lens-card bg-white p-5 rounded-3xl shadow-sm border border-gray-50 flex flex-col justify-between hover:shadow-md">
                    <div class="flex justify-between items-start mb-3">
                        <h3 class="text-lg font-bold text-[#063356] max-w-[70%]">${item[nameKey] || 'Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…Ø³Ù…Ù‰'}</h3>
                        <span class="bg-[#eef2ff] text-[#063356] font-black px-3 py-2 rounded-2xl text-sm shadow-sm">
                            ${item[priceKey] || '--'} <small class="text-[10px]">JOD</small>
                        </span>
                    </div>
                    <div class="space-y-2 border-t pt-3 mt-auto">
                        ${keys.filter(k => k !== priceKey && k !== nameKey && item[k] && item[k] !== "").map(k => `
                            <div class="flex justify-between items-center text-xs">
                                <span class="text-gray-400 font-medium">${k}:</span>
                                <span class="text-gray-700 font-bold">${item[k]}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }).join('');
    }

    // Ø¨Ù†Ø§Ø¡ Ø´Ø±ÙŠØ· Ø§Ù„ØªØ§Ø¨Ø§Øª
    function setupTabs() {
        const container = document.getElementById('tabsContainer');
        tabs.forEach((tab, index) => {
            const btn = document.createElement('button');
            btn.innerText = tab === 'Contact Lenses' ? 'Ø¹Ø¯Ø³Ø§Øª Ù„Ø§ØµÙ‚Ø© ğŸ‘ï¸' : tab;
            btn.className = `brand-btn whitespace-nowrap px-6 py-3 rounded-2xl font-bold text-sm transition-all border-2 border-transparent shadow-sm ${index === 0 ? 'active-tab' : 'bg-white text-gray-500'}`;
            btn.onclick = () => {
                document.querySelectorAll('.brand-btn').forEach(b => b.classList.remove('active-tab'));
                btn.classList.add('active-tab');
                fetchTabData(tab);
                // ØªÙ…Ø±ÙŠØ± Ø§Ù„ØªØ§Ø¨ Ù„Ù…Ù†ØªØµÙ Ø§Ù„Ø´Ø§Ø´Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· (Ù„Ù„Ø¢ÙŠØ¨Ø§Ø¯)
                btn.scrollIntoView({ behavior: 'smooth', inline: 'center', block: 'nearest' });
            };
            container.appendChild(btn);
        });
    }

    // Ù…Ø­Ø±Ùƒ Ø§Ù„Ø¨Ø­Ø«
    document.getElementById('searchInput').addEventListener('input', (e) => {
        const term = e.target.value.toLowerCase();
        const filtered = currentData.filter(row => 
            Object.values(row).some(val => String(val).toLowerCase().includes(term))
        );
        renderCards(filtered);
    });

    // Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚
    setupTabs();
    fetchTabData(tabs[0]); // ØªØ­Ù…ÙŠÙ„ Ø£ÙˆÙ„ ØªØ§Ø¨Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
</script>
</body>
</html>
