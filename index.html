<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Rawand Optical | Price List</title>
    <link rel="apple-touch-icon" href="https://assets.softr-files.com/applications/1332b07e-2803-4ca2-961e-48de84f7f376/assets/c34235fe-b50f-4223-af79-8554e3437b9f.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap');
        body { font-family: 'Tajawal', sans-serif; background-color: #f1f5f9; }
        .active-tab { background-color: #063356 !important; color: white !important; transform: scale(1.05); box-shadow: 0 5px 15px rgba(6, 51, 86, 0.3); }
        .lens-card { transition: all 0.2s ease; border-radius: 1.5rem; border: 1px solid rgba(0,0,0,0.05); }
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="pb-10 text-right">

    <header class="bg-white sticky top-0 z-50 border-b p-4 shadow-sm flex justify-between items-center">
        <img src="https://assets.softr-files.com/applications/1332b07e-2803-4ca2-961e-48de84f7f376/assets/c5680a02-6638-4d63-9827-84c7e087b62b.png" class="h-10">
        <div class="text-left font-black text-[#063356]">RAWAND OPTICAL</div>
    </header>

    <main class="max-w-4xl mx-auto px-4 mt-6">
        <input type="text" id="searchInput" placeholder="Ø¨Ø­Ø« Ø³Ø±ÙŠØ¹ ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©..." 
            class="w-full p-4 rounded-2xl shadow-md border-none mb-6 outline-none focus:ring-2 focus:ring-[#063356] text-lg">

        <div id="tabsContainer" class="flex gap-2 overflow-x-auto pb-4 no-scrollbar mb-6"></div>

        <div id="cardsGrid" class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="col-span-full text-center py-20 text-gray-400 font-bold animate-pulse">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>
        </div>
    </main>

<script>
    const sheetId = '11rfaJLxUx5CIc_znlntQ3udyqPujSAPXFFRFjAsePlk';
    
    // Ø±Ø¨Ø· Ø§Ø³Ù… Ø§Ù„ØªØ§Ø¨Ø© Ø¨Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø®Ø§Øµ Ø¨Ù‡Ø§ (GID) Ù…Ù† Ù…Ù„ÙÙƒ
    const tabsConfig = [
        { name: 'Zeiss', gid: '204294561' },
        { name: 'Hoya', gid: '1241908852' },
        { name: 'Nova', gid: '1613947230' },
        { name: 'Divel', gid: '1802967119' },
        { name: 'Synchrony', gid: '1249767351' },
        { name: 'Local Lenses', gid: '300753051' },
        { name: 'Contact Lenses', gid: '1796541571' }
    ];

    let currentData = [];

    async function loadSheet(tab) {
        const grid = document.getElementById('cardsGrid');
        grid.innerHTML = '<div class="col-span-full text-center py-20 text-gray-400">ØªØ­Ù…ÙŠÙ„ ' + tab.name + '...</div>';
        
        // Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù„Ù„Ù€ CSV Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù€ GID
        const url = `https://docs.google.com/spreadsheets/d/${sheetId}/pub?gid=${tab.gid}&output=csv`;
        
        try {
            const response = await fetch(url);
            if (!response.ok) throw new Error();
            const csvText = await response.text();
            
            const rows = csvText.split('\n').map(row => {
                // ØªÙ‚Ø·ÙŠØ¹ Ø§Ù„ØµÙ Ù…Ø¹ Ù…Ø±Ø§Ø¹Ø§Ø© Ø§Ù„ÙÙˆØ§ØµÙ„ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù†ØµÙˆØµ
                return row.match(/(".*?"|[^",\s]+)(?=\s*,|\s*$)/g)?.map(v => v.replace(/^"|"$/g, '').trim()) || [];
            });

            const headers = rows[0];
            const items = rows.slice(1).map(row => {
                let obj = {};
                headers.forEach((h, i) => { if(row[i]) obj[h] = row[i]; });
                return obj;
            }).filter(item => Object.keys(item).length > 0);

            currentData = items;
            render(items);
        } catch (e) {
            grid.innerHTML = `<div class="col-span-full text-center py-10 text-red-500 bg-red-50 rounded-2xl p-4">
                ØªØ¹Ø°Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.<br>ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ø®ØªÙŠØ§Ø± (Entire Document) Ø¹Ù†Ø¯ Ø§Ù„Ù†Ø´Ø±.
            </div>`;
        }
    }

    function render(data) {
        const grid = document.getElementById('cardsGrid');
        if (data.length === 0) { grid.innerHTML = '<div class="col-span-full text-center py-10">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…ØªØ§Ø­Ø©</div>'; return; }

        grid.innerHTML = data.map(item => {
            const entries = Object.entries(item);
            const name = entries[0][1];
            const price = entries.find(([k, v]) => !isNaN(parseFloat(v)) && v.length < 7)?.[1] || "--";

            return `
                <div class="lens-card bg-white p-6 shadow-sm flex flex-col hover:shadow-xl">
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-lg font-extrabold text-[#063356] ml-2 leading-tight">${name}</h3>
                        <div class="bg-blue-50 text-[#063356] px-4 py-1 rounded-2xl font-black text-sm whitespace-nowrap">
                            ${price} <span class="text-[10px]">JOD</span>
                        </div>
                    </div>
                    <div class="space-y-2 mt-auto border-t pt-3">
                        ${entries.map(([k, v]) => (v && v !== price && v !== name) ? `
                            <div class="flex justify-between text-xs gap-4">
                                <span class="text-gray-400 font-medium">${k}:</span>
                                <span class="text-gray-700 font-bold text-left">${v}</span>
                            </div>
                        ` : '').join('')}
                    </div>
                </div>
            `;
        }).join('');
    }

    // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªØ§Ø¨Ø§Øª
    const tBox = document.getElementById('tabsContainer');
    tabsConfig.forEach((tab, i) => {
        const btn = document.createElement('button');
        btn.innerText = tab.name === 'Contact Lenses' ? 'Ø¹Ø¯Ø³Ø§Øª Ù„Ø§ØµÙ‚Ø© ğŸ‘ï¸' : tab.name;
        btn.className = `brand-btn whitespace-nowrap px-6 py-3 rounded-2xl font-bold text-sm transition-all border-2 border-transparent ${i===0?'active-tab':'bg-white text-gray-500 shadow-sm'}`;
        btn.onclick = () => {
            document.querySelectorAll('.brand-btn').forEach(b => b.classList.remove('active-tab'));
            btn.classList.add('active-tab');
            loadSheet(tab);
            btn.scrollIntoView({ behavior: 'smooth', inline: 'center' });
        };
        tBox.appendChild(btn);
    });

    document.getElementById('searchInput').oninput = (e) => {
        const val = e.target.value.toLowerCase();
        render(currentData.filter(i => Object.values(i).some(v => String(v).toLowerCase().includes(val))));
    };

    loadSheet(tabsConfig[0]);
</script>
</body>
</html>
